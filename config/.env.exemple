# ===== DATABASE CONFIGURATION =====

# PostgreSQL connection
DATABASE_URL=postgres://mithril:dev_password@postgres:5432/mithril

# PostgreSQL credentials (used by docker-compose)
POSTGRES_USER=mithril
POSTGRES_PASSWORD=dev_password
POSTGRES_DB=mithril

# ===== REDIS CONFIGURATION =====

# Redis connection
REDIS_URL=redis://redis:6379

# Redis password (leave empty for dev, set in production)
REDIS_PASSWORD=

# Redis DB number (0-15)
REDIS_DB=0

# ===== NATS CONFIGURATION =====

# NATS server connection
NATS_URL=nats://nats:4222

# NATS cluster name (for JetStream)
NATS_CLUSTER=mithril-cluster

# NATS subject prefix (organize topics)
NATS_SUBJECT_PREFIX=mithril

# ===== 42 SCHOOL OAUTH =====

# Get these from https://profile.intra.42.fr/oauth/applications
42_CLIENT_ID=your_client_id_here
42_CLIENT_SECRET=your_client_secret_here
42_REDIRECT_URI=http://localhost:3000/api/auth/callback

# For production, change to:
# 42_REDIRECT_URI=https://yourdomain.com/api/auth/callback

# ===== AUTHENTICATION & JWT =====

# Secret key for JWT signing (generate a random string, keep it secret!)
# Generate with: openssl rand -base64 32
JWT_SECRET=your_jwt_secret_key_here_change_this_in_production

# JWT token expiry (duration string)
JWT_EXPIRY=15m

# Refresh token expiry (if using refresh tokens)
REFRESH_TOKEN_EXPIRY=7d

# API key for internal service-to-service communication
API_KEY=your_api_key_here_change_in_production

# ===== SERVER CONFIGURATION =====

# API server port
PORT=3000
API_PORT=3000

# API server host (0.0.0.0 for all interfaces)
HOST=0.0.0.0

# Environment: development, staging, production
ENVIRONMENT=development
ENV=development

# ===== LOGGING CONFIGURATION =====

# Log level: debug, info, warn, error
LOG_LEVEL=debug

# Log format: json, text
LOG_FORMAT=text

# ===== DOCKER CONFIGURATION =====

# Node ID for worker containers (used in compose override)
NODE_ID=1

# Number of worker replicas (in docker-compose)
WORKER_REPLICAS=3

# ===== GRADING SERVICE CONFIGURATION =====

# Grading timeout (seconds)
GRADING_TIMEOUT=30

# Maximum code size (bytes)
MAX_CODE_SIZE=10485760

# Maximum output size (bytes)
MAX_OUTPUT_SIZE=1048576

# Sandbox image
SANDBOX_IMAGE=tutors42lyon/mithril-sandbox:latest

# Execution timeout for code (seconds)
EXECUTION_TIMEOUT=10

# ===== SECURITY CONFIGURATION =====

# TLS/SSL certificates (if using HTTPS)
TLS_CERT_PATH=/app/certs/server.crt
TLS_KEY_PATH=/app/certs/server.key

# CA certificate for client validation
TLS_CA_PATH=/app/certs/ca.crt

# Enable TLS (true/false)
ENABLE_TLS=false

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# Rate limiting
RATE_LIMIT=100
RATE_LIMIT_WINDOW=60

# ===== DATABASE CONFIGURATION (Advanced) =====

# Connection pool size
DB_POOL_SIZE=10

# Connection timeout (seconds)
DB_CONNECTION_TIMEOUT=30

# Statement cache size
DB_STATEMENT_CACHE_SIZE=10

# ===== REDIS CONFIGURATION (Advanced) =====

# Redis max idle connections
REDIS_MAX_IDLE=10

# Redis idle timeout (seconds)
REDIS_IDLE_TIMEOUT=300

# Redis key prefix
REDIS_KEY_PREFIX=mithril:

# ===== NATS CONFIGURATION (Advanced) =====

# NATS max reconnect attempts
NATS_MAX_RECONNECT=60

# NATS reconnect timeout (seconds)
NATS_RECONNECT_TIMEOUT=3

# NATS request timeout (seconds)
NATS_REQUEST_TIMEOUT=5

# Enable NATS monitoring
NATS_MONITORING=false

# ===== APPLICATION FEATURES =====

# Enable code caching
ENABLE_CACHE=true

# Enable metrics
ENABLE_METRICS=true

# Enable profiling
ENABLE_PROFILING=false

# ===== DEVELOPMENT ONLY =====

# Enable debug mode
DEBUG=false

# Enable database migrations on startup
RUN_MIGRATIONS=true

# Seed database on startup
SEED_DATABASE=false

# Mock 42 API (for testing without real OAuth)
MOCK_42_API=false


# ===== EXERCISE & POOL CONFIGURATION =====

# Default pool ID
DEFAULT_POOL_ID=1

# Maximum exercises per pool
MAX_EXERCISES_PER_POOL=100

# ===== SESSION CONFIGURATION =====

# Session timeout (minutes)
SESSION_TIMEOUT=120

# Session storage backend (redis, database)
SESSION_BACKEND=redis

# ===== CACHE CONFIGURATION =====

# Cache TTL (seconds)
CACHE_TTL=3600

# Cache backend (redis, memory)
CACHE_BACKEND=redis

# ===== NOTIFICATION CONFIGURATION =====

# Enable notifications
ENABLE_NOTIFICATIONS=true

# Notification backend (email, slack, webhook)
NOTIFICATION_BACKEND=email

# Webhook URL for notifications
WEBHOOK_URL=

# ===== FEATURE FLAGS =====

# Enable new submission UI
FEATURE_NEW_SUBMISSION_UI=false

# Enable real-time updates
FEATURE_REALTIME_UPDATES=true

# Enable code analysis
FEATURE_CODE_ANALYSIS=false

# ===== LIMITS & QUOTAS =====

# Max submissions per user per day
MAX_SUBMISSIONS_PER_DAY=100

# Max concurrent submissions
MAX_CONCURRENT_SUBMISSIONS=10

# Max users per exam
MAX_USERS_PER_EXAM=1000

